Practical notes
Pagination and sorting:

Parameters: Keep PageSize bounded to protect the DB. Consider defaults via appsettings.

Sorting: Validate sortBy against allowed fields to avoid dynamic LINQ injections.

Idempotency:

Scope: Apply to POST/PUT/PATCH endpoints with side effects.

Expiry: Add TTL to records and a cleanup job. Persist the response shape if you need exact replay.

Domain events:

Transaction boundary: Dispatch events after a successful SaveChangesAsync to avoid emitting on rolled-back transactions.

Handlers: Keep side effects isolated (e.g., send email, publish message). Consider outbox pattern for reliable external delivery.